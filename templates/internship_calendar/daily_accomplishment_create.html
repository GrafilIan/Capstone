{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Calendar Panel | Bulan Campus</title>
  <link rel="stylesheet" href="{% static 'style/createdailyreport.css' %}">
    <link rel="stylesheet" href="{% static 'style/sidebar.css' %}">

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>

</head>
<body>

    <div class="sidebar">
        <div class="logo-details">
            <img src="{% static 'images/Revised-SSU-Logo.png' %}" alt="logo">
            <span class="logo_name">Sorsogon State University - Bulan Campus</span>
        </div>

        <ul class="nav-links">
            <li>
                <a href="StudentDashboard.html">
                    <i class='bx bxs-dashboard'></i>
                    <span class="link_name">Dashboard</span>
                </a>
                <ul class="sub-menu blank">
                    <li><a class="link_name" href="{% static 'StudentDashboard.html' %}">Dashboard</a></li>
                </ul>
            </li>
            <li>
                <a href="{% url 'calendar_view' %}">
                    <i class='bx bx-calendar-event'></i>
                    <span class="link_name">Calendar</span>
                </a>
                <ul class="sub-menu blank">
                    <li><a class="link_name" href="{% url 'calendar_view' %}">Calendar</a></li>
                </ul>
            <li>
                <div class="icon-link">
                    <a href="#">
                        <i class='bx bxs-folder-open' ></i>
                        <span class="link_name">Records</span>
                    </a>
                    <i class="bx bxs-chevron-down arrow"></i>
                </div>
                <ul class="sub-menu">
                    <li><a class="link_name" href="#">Records</a></li>
                    <li><a href="Requirements.html">Internship Requirements</a></li>
                    <li><a href="Weekly.html">Weekly Reports</a></li>
                    <li><a href="Narrative.html">Narrative Report</a></li>
                </ul>
            </li>
            <li>
                <a href="StudentEvaluation.html">
                    <i class='bx bxs-door-open' ></i>
                    <span class="link_name">Evaluation</span>
                </a>
                <ul class="sub-menu blank">
                    <li><a class="link_name" href="StudentEvaluation.html">Evaluation</a></li>
                </ul>
            </li>
            <li>
                <a href="{% url 'logout' %}">
                    <i class='bx bxs-log-out'></i>
                    <span class="link_name">Log-out</span>
                </a>
                <ul class="sub-menu blank">
                    <li><a class="link_name" href="{% url 'logout' %}">Log-out</a></li>
                </ul>
            </li>
            <li>
        <div class="profile-details">
            <div class="profile-content">
                <a href="#"><img src="{% static 'images/PicsArt_08-23-11.10.20.jpg' %}" alt="profile"></a>
            </div>
            <div class="name-job">
                <div class="profile_name">Dela Cruz Juanna</div>
                <div class="job">Full-Stack Web Developer</div>
                <div class="company">Doofinshmirtz Incorporated</div>
            </div>

            <i class= ></i>
            </a>
        </div>
            </li>
        </ul>
    </div>

    <section class="home-section">
        <div class="home-content">
            <i class='bx bx-menu'></i>
            <span class="text">Calendar Reports</span>
        </div>
    </section>
<!-----------------------------------------------Side Bar /end----------------------------------------------------->

<div class="DailyAccomplishement">
  <h2>Create Daily Accomplishment Report for {{ bin_date|date:"F d, Y" }}</h2>

  {% if accomplishments %}
    <!-- Display existing accomplishments if they exist -->
    <h3>Existing Accomplishments:</h3>
    <ul>
      {% for accomplishment in accomplishments %}
        <li>{{ accomplishment.text_submission }}</li>
        {% if accomplishment.document_submission %}
          <li><a href="{{ accomplishment.document_submission.url|safe }}" target="_blank">Download File</a></li>
        {% endif %}
      {% endfor %}
    </ul>
  {% endif %}

<form id="DailyAccomplishmentForm" method="post" enctype="multipart/form-data">
    {% csrf_token %}
    <input type="date" name="date" value="{{ bin_date|date:"Y-m-d" }}" required>
    <textarea name="text_submission" placeholder="Text Submission"></textarea>
    <input type="file" name="document_submission">

    <button type="submit" class="submit-button">Submit</button>
    <button type="submit" class="rest-day-button" name="rest_day" value="true">Rest Day</button>
</form>

    <a href="{% url 'test_messages' %}">Test Messages</a><br>
  <a href="{% url 'calendar_view' %}">Back to Calendar</a>
</div>

<!-----------------------------Time In Out-------------------------------------->

<div class="dtr">
    <h1>Time In/Out Management System</h1>
    <h2>Time Record for {{ selected_date|date:"F d, Y" }}</h2>

    <form id="TimeRecord" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        {{ time_record_form.is_time_in }}
        <button type="submit" name="is_time_in" value="on">Time In</button>
        <button type="submit" name="is_time_in" value="off">Time Out</button>
    </form>

    <h3>Time In/Out Records:</h3>
    <table>
        <thead>
            <tr>
                <th>Date/Time</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% for record in time_records %}
                <tr>
                    <td>{{ record.timestamp|date:"M. d, Y, P" }}</td>
                    <td>{{ record.action }}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>



    <form method="post" action="{% url 'download_history' %}">
        {% csrf_token %}
        <button type="submit" name="download_history" value="true">Download History</button>
    </form>

    <form method="post" action="{% url 'clear_history' %}">
        {% csrf_token %}
        <button type="submit">Clear History</button>
    </form>

    <br><br>
</div>
<!-----------------------------Time In Out/end-------------------------------------->


<!-----------------------------View Time Records------------------------------------>

<!-----------------------------View Time Records------------------------------------>

<script>
    let arrow = document.querySelectorAll(".arrow");
    for (var i = 0; i < arrow.length; i++) {
        arrow[i].addEventListener("click", (e) => {
            let arrowParent = e.target.parentElement.parentElement;
            arrowParent.classList.toggle("showMenu");
        });
    }

    let sidebar = document.querySelector(".sidebar");
    let sidebarBtn = document.querySelector(".bx-menu");

    // Check if the sidebar was open before the page was refreshed
    if (localStorage.getItem("sidebarState") === "open") {
        sidebar.classList.remove("close");
    } else {
        sidebar.classList.add("close");
    }

    sidebarBtn.addEventListener("click", () => {
        sidebar.classList.toggle("close"); // Toggle the sidebar open/close
        // Store the state in local storage
        if (sidebar.classList.contains("close")) {
            localStorage.setItem("sidebarState", "closed");
        } else {
            localStorage.setItem("sidebarState", "open");
        }
    });

        document.querySelector('#TimeRecord button[value="off"]').addEventListener('click', function() {
    // Set the value of the hidden input field to 'false' for "Time Out"
    document.querySelector('#TimeRecord input[name="is_time_in"]').value = 'false';
    // Submit the form for "Time Out"
    document.querySelector('#TimeRecord').submit();
});

    // Add event listener to the document to close sidebar when clicking outside of it
    document.addEventListener("click", (e) => {
        if (!sidebar.contains(e.target) && e.target !== sidebarBtn && !sidebar.classList.contains("close")) {
            // Clicked outside of the open sidebar and not on the sidebar button
            sidebar.classList.add("close");
            // Update the state in local storage
            localStorage.setItem("sidebarState", "closed");
        }
    });



</script>




<!-----------------------------Time In Out-------------------------------------->

<!-----------------------------Time In Out/end-------------------------------------->


</body>
</html>