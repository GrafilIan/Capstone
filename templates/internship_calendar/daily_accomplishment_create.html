{% extends 'base.html' %}
{% load static %}

{% block title %} Daily Submission Panel | Bulan Campus {% endblock %}

{% block head %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Calendar Panel | Bulan Campus</title>
    <link rel="stylesheet" href="{% static 'style/sidebar.css' %}">
    <link rel="stylesheet" href="{% static 'style/createdailyreport.css' %}">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>

{% endblock %}

{% block content %}

<div class="DailyAccomplishement">
<div class="DailyAccomplishment">
  <h2>Create Daily Accomplishment Report</h2><br>

  {% if date %}
    <p>Date: {{ date }}</p>
  {% endif %}

  <form id="DailyAccomplishmentForm" method="post" enctype="multipart/form-data">
    {% csrf_token %}
    {% if date %}
      <input type="hidden" name="date" value="{{ date }}">
    {% endif %}
    <label for="text_submission">Text Submission:</label>
    <textarea id="text_submission" name="text_submission" placeholder="Text Submission" required></textarea><br>

    <label for="document_submission">Document Submission:</label>
    <input type="file" id="document_submission" name="document_submission"><br>

    <button type="submit" class="submit-button">Submit</button>
    <button type="submit" class="rest-day-button" name="rest_day" value="true">Rest Day</button>
  </form>

  {% if accomplishments %}
    <!-- Display existing accomplishments if they exist -->
    <h3>Existing Accomplishments:</h3>
    <ul>
      {% for accomplishment in accomplishments %}
        <li>{{ accomplishment.text_submission }}</li>
        {% if accomplishment.document_submission %}
          <li><a href="{{ accomplishment.document_submission.url|safe }}" target="_blank">Download File</a></li>
        {% endif %}
      {% endfor %}
    </ul>
  {% endif %}

</div>


</div>

<!-----------------------------Time In Out-------------------------------------->

    <form method="post" action="{% url 'download_history' %}">
        {% csrf_token %}
        <button type="submit" name="download_history" value="true">Download History</button>
    </form>


    <br><br>

{% endblock %}

{% block scripts %}

    <script>
  document.addEventListener("DOMContentLoaded", function() {
    // Get all day elements in the calendar
    const dayElements = document.querySelectorAll(".day");

    // Loop through each day element
    dayElements.forEach(dayElement => {
      // Extract the date from the day element's ID
      const date = dayElement.id.replace("day-", "");

      // Check if the date is marked as a rest day (you need to implement this logic)
      // For demonstration purposes, let's assume rest days are marked in a JavaScript object
      const restDays = {
        "2023-10-05": true, // Example rest day, format: "YYYY-MM-DD"
        // Add more rest days as needed
      };

      // Apply CSS class based on whether it's a rest day
      if (date in restDays) {
        dayElement.classList.add("rest-day");
      }
    });
  });
  </script>

  <script>
  document.addEventListener("DOMContentLoaded", function() {
    const restDayButton = document.querySelector('button[name="rest_day"]');
    const addButton = document.getElementById('add-button');

    restDayButton.addEventListener("click", function() {
      addButton.classList.add("red-button"); // Add a CSS class to change the button color to red
    });
  });
  </script>



<script>
    let arrow = document.querySelectorAll(".arrow");
    for (var i = 0; i < arrow.length; i++) {
        arrow[i].addEventListener("click", (e) => {
            let arrowParent = e.target.parentElement.parentElement;
            arrowParent.classList.toggle("showMenu");
        });
    }

    let sidebar = document.querySelector(".sidebar");
    let sidebarBtn = document.querySelector(".bx-menu");

    sidebarBtn.addEventListener("click", () => {
        sidebar.classList.toggle("close");
    });

    // Add event listener to the document to close sidebar when clicking outside of it
    document.addEventListener("click", (e) => {
        if (!sidebar.contains(e.target) && !sidebarBtn.contains(e.target)) {
            // Clicked outside of both the sidebar and sidebar button
            sidebar.classList.add("close");
        }
    });
</script>

    <script src="{% static 'script/StudentCalendar.js' %}"></script>
{% endblock %}
